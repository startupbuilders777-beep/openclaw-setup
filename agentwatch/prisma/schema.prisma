// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

// Agent model - represents AI agents being monitored
model Agent {
  id          String   @id @default(cuid())
  name        String
  description String?
  status      String   @default("inactive") // active, inactive, error
  type        String   // openai, anthropic, custom, etc.
  config      String?  // JSON config for the agent
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  metrics     Metric[]
  tasks       Task[]
}

// Metric model - stores performance metrics for agents
model Metric {
  id          String   @id @default(cuid())
  agentId     String
  type        String   // cpu, memory, latency, cost, tokens, etc.
  value       Float
  unit        String?  // ms, MB, $, tokens, etc.
  timestamp   DateTime @default(now())
  metadata    String?  // Additional JSON metadata

  agent       Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)

  @@index([agentId])
  @@index([timestamp])
}

// Task model - tracks tasks executed by agents
model Task {
  id          String   @id @default(cuid())
  agentId     String
  name        String
  description String?
  status      String   @default("pending") // pending, running, completed, failed
  result      String?  // JSON result
  error       String?  // Error message if failed
  startedAt   DateTime @default(now())
  completedAt DateTime?
  duration    Int?     // Duration in milliseconds

  agent       Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)

  @@index([agentId])
  @@index([status])
  @@index([startedAt])
}
